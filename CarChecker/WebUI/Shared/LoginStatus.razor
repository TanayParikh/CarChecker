@using Microsoft.AspNetCore.Components.WebAssembly.Authentication
@inject NavigationManager Navigation
@inject ILocalVehiclesStore LocalVehiclesStore
@inject IStringLocalizer<App> Localize
@inject IAccountManager AccountManager

<AuthorizeView>
    <div class="username">
        <img src="_content/CarChecker/user.svg" />
        <div>
            <div><strong>@context.User.FirstName() @context.User.LastName()</strong></div>
            <div>@context.User.Email()</div>
        </div>
    </div>
    <div class="user-actions">
        <a class="text-button" href="authentication/profile">
            @Localize["Manage account"]
        </a>
        <button class="text-button" @onclick="BeginLogOut">
            @Localize["Log out"]
        </button>
    </div>
</AuthorizeView>

@code {
    private async Task BeginLogOut()
    {
        await LocalVehiclesStore.SaveUserAccountAsync(null);
        await AccountManager.SignOut();
    }
}
